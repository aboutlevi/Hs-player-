<!DOCTYPE html>
<html lang="fr" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° SportStream Pro - Lecteur Premium</title>
    
    <!-- Bootstrap 5 Dark Theme -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Video.js avec skin premium -->
    <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
    <link href="https://unpkg.com/@videojs/themes@1.0.0/dist/forest/index.css" rel="stylesheet">
    
    <!-- Animate.css pour animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Custom CSS Premium -->
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --warning-gradient: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            --dark-bg: #0f172a;
            --darker-bg: #0a0f1c;
            --card-bg: rgba(30, 41, 59, 0.7);
            --glass-effect: backdrop-filter: blur(10px) saturate(180%);
        }
        
        body {
            background: var(--dark-bg);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            color: #e2e8f0;
            overflow-x: hidden;
        }
        
        .navbar-glass {
            background: rgba(15, 23, 42, 0.8) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .hero-gradient {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .card-glass {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .card-glass:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .btn-gradient-primary {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-gradient-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .player-container {
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .badge-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track { background: rgba(30, 41, 59, 0.5); border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: var(--primary-gradient); border-radius: 10px; }
        
        .fade-in-up { animation: fadeInUp 0.8s ease-out; }
        @keyframes fadeInUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }
        
        .badge-4k { background: linear-gradient(135deg, #ff6b6b, #ee5a24); }
        .badge-fhd { background: linear-gradient(135deg, #48dbfb, #0abde3); }
        .badge-hd { background: linear-gradient(135deg, #1dd1a1, #10ac84); }
        .badge-sd { background: linear-gradient(135deg, #8395a7, #576574); }
        .badge-live { background: linear-gradient(135deg, #ff9f43, #ee5253); }
        
        .channel-card { cursor: pointer; transition: all 0.3s cubic-bezier(0.4,0,0.2,1); border-left: 4px solid transparent; }
        .channel-card:hover { border-left-color: #667eea; background: rgba(102,126,234,0.1); }
        .channel-card.active { border-left-color: #10b981; background: rgba(16,185,129,0.1); }
        
        .stats-card { background: rgba(255,255,255,0.05); border-radius:15px; padding:20px; text-align:center; }
        .stats-number { font-size:2.5rem; font-weight:700; background:linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        
        .skeleton { background: linear-gradient(90deg,#1e293b 25%,#334155 50%,#1e293b 75%); background-size:200% 100%; animation:loading 1.5s infinite; }
        @keyframes loading { 0%{background-position:200% 0;} 100%{background-position:-200% 0;} }
    </style>
</head>
<body class="bg-dark text-light">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-glass fixed-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <div class="bg-gradient-primary rounded-circle p-2 me-2">
                    <i class="bi bi-play-circle-fill fs-4"></i>
                </div>
                <span class="fw-bold fs-4">SportStream <span class="text-gradient-primary">Pro</span></span>
            </a>
            <div class="d-flex align-items-center">
                <div class="me-3">
                    <span class="badge bg-success badge-pulse">
                        <i class="bi bi-circle-fill me-1"></i> LIVE
                    </span>
                </div>
                <button class="btn btn-gradient-primary" onclick="toggleTheme()">
                    <i class="bi bi-moon-stars"></i> Th√®me
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-gradient py-5 mt-5">
        <div class="container py-5">
            <div class="row align-items-center">
                <div class="col-lg-6 fade-in-up">
                    <h1 class="display-4 fw-bold mb-4">
                        Stream Sportif <span class="text-warning">Premium</span>
                    </h1>
                    <p class="lead mb-4">
                        Acc√©dez √† des centaines de cha√Ænes sportives en qualit√© HD/4K.
                        Interface moderne, performances optimis√©es.
                    </p>
                    <div class="d-flex gap-3">
                        <button class="btn btn-gradient-primary" onclick="showStats()">
                            <i class="bi bi-bar-chart me-2"></i> Statistiques
                        </button>
                        <button class="btn btn-outline-light" onclick="showGuide()">
                            <i class="bi bi-question-circle me-2"></i> Guide
                        </button>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="position-relative">
                        <div id="statsOverlay" class="card-glass p-4 position-absolute top-0 end-0 d-none" style="z-index:10;">
                            <h5><i class="bi bi-speedometer2 me-2"></i> Stats Live</h5>
                            <div class="row text-center mt-3">
                                <div class="col-4">
                                    <div class="stats-card">
                                        <div class="stats-number" id="channelCount">0</div>
                                        <small>Cha√Ænes</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="stats-card">
                                        <div class="stats-number" id="qualityHD">0</div>
                                        <small>HD+</small>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="stats-card">
                                        <div class="stats-number" id="liveChannels">0</div>
                                        <small>Live</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="player-container mt-5">
                            <video id="video-player" class="video-js vjs-theme-forest vjs-fluid" controls preload="auto"
                                   poster="https://images.unsplash.com/photo-1551958219-acbc608c6377?w=1200&auto=format">
                                <p class="vjs-no-js">JavaScript est requis pour ce lecteur.</p>
                            </video>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container py-5">
        <!-- Controls -->
        <div class="row mb-4">
            <div class="col-md-8">
                <div class="card-glass p-3">
                    <div class="d-flex flex-wrap gap-2 align-items-center">
                        <span class="fw-bold me-2"><i class="bi bi-sliders"></i> Contr√¥les :</span>
                        <select id="qualitySelect" class="form-select form-select-sm bg-dark text-light" style="width:auto;">
                            <option value="auto">üéØ Qualit√© Auto</option>
                            <option value="1080">üé¨ Full HD (1080p)</option>
                            <option value="720">üì∫ HD (720p)</option>
                            <option value="480">üì± SD (480p)</option>
                        </select>
                        <button class="btn btn-sm btn-outline-light" onclick="toggleFullscreen()">
                            <i class="bi bi-arrows-fullscreen"></i> Plein √©cran
                        </button>
                        <button class="btn btn-sm btn-outline-success" onclick="reloadStream()">
                            <i class="bi bi-arrow-clockwise"></i> Recharger
                        </button>
                        <button class="btn btn-sm btn-outline-warning" onclick="captureSnapshot()">
                            <i class="bi bi-camera"></i> Capture
                        </button>
                        <div class="ms-auto">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="autoPlay" checked>
                                <label class="form-check-label" for="autoPlay">Auto-play</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card-glass p-3">
                    <div class="input-group">
                        <span class="input-group-text bg-dark border-dark"><i class="bi bi-search"></i></span>
                        <input type="text" id="channelSearch" class="form-control bg-dark text-light border-dark" placeholder="Rechercher une cha√Æne...">
                    </div>
                </div>
            </div>
        </div>

        <!-- Channels Grid -->
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold"><i class="bi bi-collection-play me-2"></i> Cha√Ænes Disponibles <span class="badge bg-primary ms-2" id="totalChannels">0</span></h3>
                    <div class="btn-group" role="group">
                        <button class="btn btn-outline-light btn-sm active" data-filter="all">Toutes</button>
                        <button class="btn btn-outline-light btn-sm" data-filter="hd">HD+</button>
                        <button class="btn btn-outline-light btn-sm" data-filter="live">Live</button>
                        <button class="btn btn-outline-light btn-sm" data-filter="football">Football</button>
                    </div>
                </div>
                
                <div id="loadingSkeleton" class="row">
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                        <div class="card-glass skeleton" style="height:100px;"></div>
                    </div>
                </div>
                
                <div id="channelsContainer" class="row d-none"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-darker py-4 mt-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="mb-0"><i class="bi bi-c-circle"></i> 2024 SportStream Pro. <span class="text-muted">Pour usage √©ducatif.</span></p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="btn-group" role="group">
                        <button class="btn btn-sm btn-outline-light" onclick="showAbout()"><i class="bi bi-info-circle"></i></button>
                        <button class="btn btn-sm btn-outline-light" onclick="refreshChannels()"><i class="bi bi-arrow-repeat"></i></button>
                        <button class="btn btn-sm btn-outline-light" onclick="showSettings()"><i class="bi bi-gear"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>

    <script>
    // ====== CONFIG ======
    const CONFIG = { autoPlay: true, defaultQuality:'auto', theme:'dark', volume:0.8, debug:false };

    class SportStreamPlayer {
        constructor() {
            this.player = null;
            this.hls = null;
            this.channels = [];
            this.currentChannel = null;
            this.filter = 'all';
            this.initPlayer();
            this.loadChannels();
            this.setupEventListeners();
        }

        initPlayer() {
            this.player = videojs('video-player', {
                fluid:true, responsive:true, autoplay:CONFIG.autoPlay,
                playbackRates:[0.5,1,1.25,1.5,2],
                controlBar:{ children:['playToggle','volumePanel','currentTimeDisplay','timeDivider','durationDisplay','progressControl','remainingTimeDisplay','playbackRateMenuButton','fullscreenToggle'] }
            });

            this.player.on('error', (e)=>{ console.error('Player error:',e); this.showError('Erreur de lecture. Essayer une autre cha√Æne.'); });
        }

        async loadChannels() {
            try {
                const m3uUrl = "https://iptv-org.github.io/iptv/index.m3u";
                const res = await fetch(m3uUrl);
                const text = await res.text();
                this.channels = this.parseM3U(text);
                this.displayChannels();
                this.updateStats();
                if(this.channels.length>0) this.loadChannel(this.channels[0]);
            } catch(e){ console.error('Error loading channels:',e); this.showError('Erreur de chargement des cha√Ænes'); }
            finally { document.getElementById('loadingSkeleton').classList.add('d-none'); document.getElementById('channelsContainer').classList.remove('d-none'); }
        }

        parseM3U(m3uText){ 
            const lines = m3uText.split('\n'); 
            const channels=[]; let info={}; 
            for(let line of lines){
                if(line.startsWith('#EXTINF')){
                    const nameMatch=line.match(/,(.+)/); 
                    info.name
